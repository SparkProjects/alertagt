var u_test_loc={"lon":-90.492634,"lat":14.649366};var marker_u={};var ucoords={"lat":"","lon":""};$(document).ready(function(){if($("#map").length){var map=L.map("map").setView([15.753,-90.291],7);var mapa=L.tileLayer("https://raw.githubusercontent.com/SparkProjects/guatemala-tiles/master/tiles/{z}/{x}/{y}.png",{"attribution":'&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',"detectRetina":false,"maxZoom":15,"minZoom":7,"errorTileUrl":"https://raw.githubusercontent.com/SparkProjects/guatemala-tiles/master/tiles/fallbacktile.png"}).addTo(map);var i_usuario=L.icon({"iconUrl":"static/img/usuario.png","iconRetinaUrl":"static/img/usuario.png","shadowUrl":"static/img/sombra.png","shadowRetinaUrl":"static/img/sombra.png","iconSize":[25,33],"shadowSize":[25,25],"iconAncor":[0,0],"shadowAnchor":[2,7],"popupAnchor":[0,-10]});var i_hospitales_a=L.icon({"iconUrl":"static/img/hospital_a.png","iconRetinaUrl":"static/img/hospital_a.png","shadowUrl":"static/img/sombra.png","shadowRetinaUrl":"static/img/sombra.png","iconSize":[25,33],"shadowSize":[25,25],"iconAncor":[0,0],"shadowAnchor":[2,7],"popupAnchor":[0,-10]});var i_hospitales=L.icon({"iconUrl":"static/img/hospital.png","iconRetinaUrl":"static/img/hospital.png","shadowUrl":"static/img/sombra.png","shadowRetinaUrl":"static/img/sombra.png","iconSize":[25,33],"shadowSize":[25,25],"iconAncor":[0,0],"shadowAnchor":[2,7],"popupAnchor":[0,-10]})}function iniciar_hero(){$.getJSON("https://alertagt-api.onrender.com/ll?lon="+"10"+"&lat="+"19",function(resultados){})}iniciar_hero();function ubicacion_u_m(usuario){if(!$.isEmptyObject(marker_u)){map.removeLayer(marker_u)}marker_u=L.marker([usuario.lat,usuario.lon],{"icon":i_usuario}).addTo(map);map.setView(L.latLng(usuario.lat,usuario.lon),14,animate=true)}var c_hospitales_c={};var h_cercanos=false;$("#ubicacion_hc").click(function(event){event.preventDefault();if(map.hasLayer(c_hospitales_c)){map.removeLayer(c_hospitales_c)}else{h_cercanos=true;ubicacion_u()}});$("#b_e_no_geo").click(function(event){event.preventDefault();if(!$("#e_no_geo").hasClass("is-hidden")){$("#e_no_geo").addClass("is-hidden")}});$("#b_e_no_loc").click(function(event){event.preventDefault();if(!$("#e_no_loc").hasClass("is-hidden")){$("#e_no_loc").addClass("is-hidden")}});$("#b_e_no_dat").click(function(event){event.preventDefault();if(!$("#e_no_dat").hasClass("is-hidden")){$("#e_no_dat").addClass("is-hidden")}});$("#b_e_no_gua").click(function(event){event.preventDefault();if(!$("#e_no_gua").hasClass("is-hidden")){$("#e_no_gua").addClass("is-hidden")}});function error_no_geo(){if($("#e_no_geo").hasClass("is-hidden")){$("#e_no_geo").removeClass("is-hidden")}}function error_no_loc(){if($("#e_no_loc").hasClass("is-hidden")){$("#e_no_loc").removeClass("is-hidden")}}function error_no_dat(){if($("#e_no_dat").hasClass("is-hidden")){$("#e_no_dat").removeClass("is-hidden")}}function error_no_gua(){if($("#e_no_gua").hasClass("is-hidden")){$("#e_no_gua").removeClass("is-hidden")}}function ubicacion_u(){var opciones={"enableHighAccuracy":true,"timeout":5e3,"maximumAge":0};function success(pos){ucoords.lat=pos.coords.latitude;ucoords.lon=pos.coords.longitude;ubicacion_u_m(ucoords);if(h_cercanos){salud_cercanos()}if(h_aislamiento){salud_aislados()}}function error(err){error_no_loc()}if(!navigator.geolocation){error_no_geo()}else{navigator.geolocation.getCurrentPosition(success,error,opciones)}}function salud_cercanos(){h_cercanos=false;if(ucoords.lat!=""){$.getJSON("https://alertagt-api.onrender.com/ll?lon="+ucoords.lon+"&lat="+ucoords.lat,function(resultados){if(resultados.hasOwnProperty("mensaje")){error_no_gua()}else{c_hospitales_c=L.geoJSON(resultados,{"pointToLayer":function(feature,latlng){return L.marker(latlng,{"icon":i_hospitales})},"onEachFeature":function(feature,layer){layer.bindPopup('<p class="title is-5 has-text-centered">'+feature.properties.tipo_serv+" "+feature.properties.servicio+"</p>"+'<p class="subtitle is-6 has-text-centered">'+feature.properties.municipio+", "+feature.properties.departamen+"</p>"+'<footer class="card-footer">'+'<a target="_blank" href="https://www.google.com/maps/dir/?api=1&destination='+feature.properties.y_coord+","+feature.properties.x_coord+"&origin="+ucoords.lat+","+ucoords.lon+'" class="card-footer-item"><span class="icon is-medium"><i class="fas fa-2x fa-map-marked-alt"></i></span></a>'+'<a target="_blank" href="https://www.waze.com/ul?ll='+feature.properties.y_coord+","+feature.properties.x_coord+'&navigate=yes&zoom=15" class="card-footer-item"><span class="icon is-medium"><i class="fab fa-2x fa-waze"></i></span></a>'+"</footer>",{"maxWidth":180,"closeButton":false})}}).addTo(map)}}).fail(function(){error_no_dat()})}}});